/*
 * The MIT License (MIT)
 * 
 * Copyright (c) 2016 有限会社テンパス・フュジット Tempus Fugit,Inc.
 * http://www.tempusfugit.jp/
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
MessageDigest=function(){"use strict";function a(){}function b(a){for(var b=a.length,c=[],d=0;b>d;d++){var e=a.charCodeAt(d);127>=e?c.push(e):2047>=e?(c.push(192|e>>>6),c.push(128|63&e)):65535>=e?(c.push(224|e>>>12),c.push(128|e>>>6&63),c.push(128|63&e)):(c.push(240|e>>>18),c.push(128|e>>>12&63),c.push(128|e>>>6&63),c.push(128|63&e))}return c}function c(a){for(var b=[[]],c=0;c<a.length;c++){var d=Math.floor(c/64),e=b[d];e||(e=[],b.push(e)),e.push(a[c])}var f=b[b.length-1];for(f.push(128);f.length%64!=56;)f.push(0);for(var g=[a.length%536870912*8,8*(a.length/536870912&4294967295)],h=7;h>=0;h--)f.push(g[h/4&15]>>>h%4*8&255);return f.length>64&&(b.pop(),b.push(f.slice(0,64)),b.push(f.slice(64))),b}function d(a){return a<<1|a>>>31}function e(a){return a<<5|a>>>27}function f(a){return a<<30|a>>>2}function g(){this.__orgMsg=[]}"function"!=typeof Object.setPrototypeOf&&(Object.setPrototypeOf=function(a,b){return a.__proto__=b,a});var h=function(){throw new Error("This function must be overrided, but not.")};a.prototype._reset=h,a.prototype._update=h,a.prototype._digest=h,Object.defineProperty(a.prototype,"blockSize",{get:h}),Object.defineProperty(a.prototype,"digestSize",{get:h}),a.prototype.reset=function(){this._reset(),this.__notUpdated=!1},a.prototype.update=function(a){if("string"==typeof a?a=b(a):"number"==typeof a&&(a=4294967295&a,a=[255&a,a>>>8&255,a>>>16&255,a>>>24&255]),Array.isArray(a)&&(a=new Uint8Array(a)),!(a instanceof Uint8Array))throw new TypeError("The argument is incompatible with bytes.");return this._update(a),this.__notUpdated=!1,this},a.prototype.digest=function(){return this.__notUpdated||(this.__chachedDigest=this._digest(),this.__notUpdated=!0),this.__chachedDigest.slice(0)},a.prototype.digestStr=function(a){var b="",c=this.digest();return c.forEach(function(a){var c=a.toString(16);c.length<2&&(c="0"+c),b+=c}),a?b.toUpperCase():b.toLowerCase()},Object.defineProperty(a,"SHA1",{get:function(){return"SHA1"}});var i={};i[a.SHA1]=g,a.create=function(a){var b=i[a];return b?new b:null},a.__encUtf8=b;var j=new Array(4);j[0]=function(a,b,c){return a&b|~a&c},j[1]=function(a,b,c){return a^b^c},j[2]=function(a,b,c){return a&b|a&c|b&c},j[3]=j[1];var k=[1518500249,1859775393,2400959708,3395469782];return g.MAX_BYTES_LENGTH=9007199254740992,Object.setPrototypeOf(g.prototype,a.prototype),Object.defineProperty(g.prototype,"blockSize",{get:function(){return 64}}),Object.defineProperty(g.prototype,"digestSize",{get:function(){return 20}}),Object.defineProperty(g.prototype,"MAX_BYTES_LENGTH",{get:function(){return g.MAX_BYTES_LENGTH}}),g.prototype._reset=function(){this.__orgMsg=[]},g.prototype._update=function(a){if(g.MAX_BYTES_LENGTH-this.__orgMsg.length<a.length)throw new Error("Message length is over the limit.");for(var b=0;b<a.length;b++)this.__orgMsg.push(a[b])},g.prototype._digest=function(){for(var a=c(this.__orgMsg),b=1732584193,g=4023233417,h=2562383102,i=271733878,l=3285377520,m=0;m<a.length;m++){for(var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o=0;64>o;o++){var p=o/4&15;n[p]=n[p]|a[m][o]<<8*(3-o%4)}var q=0;for(q=16;80>q;q++)n.push(d(n[q-3]^n[q-8]^n[q-14]^n[q-16]));var r=b,s=g,t=h,u=i,v=l;for(q=0;80>q;q++){var w=q/20&255,x=e(r)+j[w](s,t,u)+v+n[q]+k[w]&4294967295;v=u,u=t,t=f(s),s=r,r=x}b=b+r&4294967295,g=g+s&4294967295,h=h+t&4294967295,i=i+u&4294967295,l=l+v&4294967295}return[b>>>24,b>>>16&255,b>>>8&255,255&b,g>>>24,g>>>16&255,g>>>8&255,255&g,h>>>24,h>>>16&255,h>>>8&255,255&h,i>>>24,i>>>16&255,i>>>8&255,255&i,l>>>24,l>>>16&255,l>>>8&255,255&l]},a}(),Hmac=function(){"use strict";function a(a){this.__digestObj=a}function b(a){if(!MessageDigest||"function"!=typeof MessageDigest.__encUtf8)throw new Error("Not found an implementation for encoding.");return MessageDigest.__encUtf8(a)}a.prototype.h=function(a,c,d){if(!(Array.isArray(a)||a instanceof Uint8Array))throw new TypeError("key must be byte sequence.");if("number"==typeof d&&1>d)throw new RangeError("length must be greater than 0.");var e=this.__digestObj.blockSize,f=[],g=[],h=0;for(a.length>e&&(this.__digestObj.reset(),a=this.__digestObj.update(a).digest()),h=0;e>h;h++)h<a.length?(f.push(255&a[h]^54),g.push(255&a[h]^92)):(f.push(54),g.push(92));"string"==typeof c&&(c=b(c)),Array.prototype.push.apply(f,c),this.__digestObj.reset(),c=this.__digestObj.update(f).digest(),Array.prototype.push.apply(g,c),this.__digestObj.reset();var i=this.__digestObj.update(g).digest();return d&&d<this.__digestObj.digestSize?i.slice(0,d):i};var c={0:1,1:2,2:3,3:4,4:5,5:6,6:7,7:8,8:9,9:10,a:11,b:12,c:13,d:14,e:15,f:16,A:11,B:12,C:13,D:14,E:15,F:16};return a.xk=function(a){for(var b=[],d=0;d<a.length;d++){var e=c[a[d]];if(!e)throw new Error("Invalid character in hex-string.");--e;var f=Math.floor(d/2);1&d?b[f]+=e:b[f]=16*e}return b},a}(),Hotp=function(){"use strict";function a(){this.counter=0,this.__hmac=new Hmac(MessageDigest.create(MessageDigest.SHA1))}function b(a){var b=15&a[19];return[a[b+3],a[b+2],a[b+1],127&a[b]]}function c(a){for(var b=0,c=0;4>c;c++)b+=a[c]<<8*c;return b}var d=9007199254740992;a.prototype.generate=function(b,c){if(this.counter>d)throw new RangeError("This instance has counted max value.");return"undefined"==typeof c&&(c=6),a.generate(b,this.count++,c,this.__hmac)},Object.defineProperty(a,"MAX_COUNT",{get:function(){return d}}),a.generate=function(a,d,e,f){if("number"!=typeof e&&(e=6),6>e)throw new RangeError("digit must greater equals 6.");if(f||(f=new Hmac(MessageDigest.create(MessageDigest.SHA1))),"number"==typeof d){var g=d%4294967296,h=d/4294967296&4294967295;d=[h>>>24&255,h>>>16&255,h>>>8&255,255&h,g>>>24&255,g>>>16&255,g>>>8&255,255&g]}var i=f.h(a,d),j=b(i),k=c(j);return k%Math.pow(10,e)};var e=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","2","3","4","5","6","7"];a.encodeBase32=function(a){for(var b="",c=0,d=0;d<a.length;)if(c+=5,8>=c)b+=e[(255&a[d])>>>8-c&31],8===c&&(c=0,++d);else{c-=8;var f=a[d]<<c&31;++d<a.length&&(f+=(255&a[d])>>>8-c&15),b+=e[f]}for(;b.length%8!==0;)b+="=";return b};var f={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,2:26,3:27,4:28,5:29,6:30,7:31,"=":0},g=/^[2-7A-Z]+(?:=|={3,4}|={6})?$/;return a.decodeBase32=function(a){if(a.length%8!==0)throw new Error("Not base32 encoded string.");if(!g.test(a))throw new Error("Not base32 encoded string.");for(var b=[],c=0;c<a.length;c+=8){for(var d=[],e=0;8>e;e++)a[c+e]in f&&d.push(f[a[c+e]]);b.push((d[0]<<3)+(d[1]>>>2)),b.push((d[1]<<6)+(d[2]<<1)+(d[3]>>>4)&255),b.push((d[3]<<4)+(d[4]>>>1)&255),b.push((d[4]<<7)+(d[5]<<2)+(d[6]>>>3)&255),b.push((d[6]<<5)+d[7]&255)}var h=a.length-a.indexOf("=");return 1===h?b=b.slice(0,b.length-1):3===h?b=b.slice(0,b.length-2):4===h?b=b.slice(0,b.length-3):6===h&&(b=b.slice(0,b.length-4)),b},a}();